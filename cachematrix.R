## the makeCacheMatrix creates a structure to cache both results
## of a computation, in this case the 'solve()' function to invert
## a invertible matrix. The results can be retrieved by using the
## getinv().

## refer to 'cacheSolve()' function to uses the structure
## makeCacheMatrix easily.

## Based on sample with cached mean: stores data in 'x' and
## the result in 'i'. When setinv() is used, the result is 
## cached on 'i', and getinv() will return the result.

makeCacheMatrix <- function(x = matrix()) {
  i <- NULL
  set <- function(y) {
    x <<- y
    i <<- NULL
  }
  get <- function() x
  setinv <- function(inv) i <<- inv
  getinv <- function() i
  list(set = set, get = get,
       setinv = setinv,
       getinv = getinv)
}


## It used the makeCacheMatrix that returns a list with fuctions to
## set() or get() data; and functions to setinv() getinv() to store 
## and get results from 'solve()' function computation.

cacheSolve <- function(x, ...) {
  ## Return a matrix that is the inverse of 'x'
  i <- x$getinv()
  if(!is.null(i)) {
    message("getting cached data")
    return(i)
  }
  data <- x$get()
  i <- solve(data, ...)
  x$setinv(i)
  i
}


## Tested with:
# > source('~/coursera-R/ProgrammingAssignment2/cachematrix.R')
# > m <- makeCacheMatrix(matrix(rnorm(100),10,10))
# > cacheSolve(m)
# [,1]       [,2]        [,3]        [,4]        [,5]
# [1,] -14.977659  2.7813995  5.91582321 -0.21799507   7.0266520
# [2,]  24.422382 -3.5832864 -9.16944882  0.05228942 -11.8258474
# [3,]   1.108523 -0.3247616  0.03404586  0.20644901  -0.7963681
# [4,] -12.946433  2.2873057  4.31858351 -0.19749744   6.3551601
# [5,]   5.372569 -0.8151429 -1.79666049  0.05855257  -2.5436728
# [6,]  16.525138 -2.1649385 -6.29268701  0.16233976  -7.8300270
# [7,]   1.501238 -1.0033705 -0.71887115 -0.39932030  -0.7053784
# [8,] -11.006773  2.2103403  4.46639043 -0.83631087   5.4590396
# [9,] -15.580862  3.1772642  6.24499266 -0.54695181   7.8612182
# [10,]   8.417596 -1.0656198 -3.22349506 -0.15085866  -3.8750830
# [,6]        [,7]       [,8]       [,9]       [,10]
# [1,]   7.2917492   6.4382428 -2.3135920 -4.2315423 -3.71011655
# [2,] -12.9159698 -10.3180146  2.5644106  7.4731331  6.40953683
# [3,]  -0.8605331  -0.5599421 -0.1810652  0.3500833 -0.05411473
# [4,]   6.4798533   5.5824609 -1.3505812 -4.0370609 -3.32209796
# [5,]  -2.9988276  -2.2170178  0.2033496  1.5920643  1.58559675
# [6,]  -8.6295484  -7.1431198  1.9963676  5.0004547  4.53127782
# [7,]  -0.8744576  -0.7448478  0.6724337  0.4602242  0.51366883
# [8,]   4.9408917   4.2710153 -2.5772153 -3.3083313 -2.95300587
# [9,]   7.9656790   6.7594651 -2.5681385 -4.9439779 -4.33401870
# [10,]  -4.9096533  -3.6183486  0.4326356  2.8287186  2.45400350
# > cacheSolve(m)
# getting cached data
# [,1]       [,2]        [,3]        [,4]        [,5]
# [1,] -14.977659  2.7813995  5.91582321 -0.21799507   7.0266520
# [2,]  24.422382 -3.5832864 -9.16944882  0.05228942 -11.8258474
# [3,]   1.108523 -0.3247616  0.03404586  0.20644901  -0.7963681
# [4,] -12.946433  2.2873057  4.31858351 -0.19749744   6.3551601
# [5,]   5.372569 -0.8151429 -1.79666049  0.05855257  -2.5436728
# [6,]  16.525138 -2.1649385 -6.29268701  0.16233976  -7.8300270
# [7,]   1.501238 -1.0033705 -0.71887115 -0.39932030  -0.7053784
# [8,] -11.006773  2.2103403  4.46639043 -0.83631087   5.4590396
# [9,] -15.580862  3.1772642  6.24499266 -0.54695181   7.8612182
# [10,]   8.417596 -1.0656198 -3.22349506 -0.15085866  -3.8750830
# [,6]        [,7]       [,8]       [,9]       [,10]
# [1,]   7.2917492   6.4382428 -2.3135920 -4.2315423 -3.71011655
# [2,] -12.9159698 -10.3180146  2.5644106  7.4731331  6.40953683
# [3,]  -0.8605331  -0.5599421 -0.1810652  0.3500833 -0.05411473
# [4,]   6.4798533   5.5824609 -1.3505812 -4.0370609 -3.32209796
# [5,]  -2.9988276  -2.2170178  0.2033496  1.5920643  1.58559675
# [6,]  -8.6295484  -7.1431198  1.9963676  5.0004547  4.53127782
# [7,]  -0.8744576  -0.7448478  0.6724337  0.4602242  0.51366883
# [8,]   4.9408917   4.2710153 -2.5772153 -3.3083313 -2.95300587
# [9,]   7.9656790   6.7594651 -2.5681385 -4.9439779 -4.33401870
# [10,]  -4.9096533  -3.6183486  0.4326356  2.8287186  2.45400350
# > 